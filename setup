#!/bin/sh

set -e

echo "# make workspace"
mkdir -p ~/Documents/workspace

echo "# always show hidden files/directories in the Finder app"
defaults write com.apple.finder AppleShowAllFiles TRUE
killall Finder

echo "# install command line tools for xcode"
if [ ! -d /Library/Developer/CommandLineTools ]; then
	xcode-select --install
fi

echo "# cd root"
cd $HOME

echo "# install if homebrew is not installed"
if ! ( type "brew" > /dev/null 2>&1 ); then
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

echo "# "
brew bundle

echo "# install if fisher is not installed"
if ! ( type "fisher" > /dev/null 2>&1 ); then
	curl -Lo ~/.config/fish/functions/fisher.fish --create-dirs https://git.io/fisher
fi

echo "# install fisher plugins(fish-ghq, dracula, fish-kubectl-cpmpletions, done, fzf, z)"
fish -C "fisher install decors/fish-ghq;and fisher install dracula/fish;and fisher install evanlucas/fish-kubectl-completions;and fisher install franciscolourenco/done;and fisher install jethrokuan/fzf;and fisher install jethrokuan/z;"

echo "# add asdf plugins"
asdf plugin add 1password-cli
asdf plugin add fzf
asdf plugin add ghq
asdf plugin add golang
asdf plugin add jq
asdf plugin add kubectl
asdf plugin add neovim
asdf plugin add nodejs
asdf plugin add python
asdf plugin add ruby
asdf plugin add rubbish https://github.com/grimoh/asdf-rubbish.git
asdf plugin add terraform

echo "# install the asdf plugin version"
asdf install

echo "# run neovim"
nvim
